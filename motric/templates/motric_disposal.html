{% extends 'motric_moresrc.html' %}

{% block title %}Disposal for requested devices{% endblock %}

{% block body %}

{% include 'motric_modal.html' %}

    <div id="translayer">&nbsp;</div>
    <div id="popupwindow">
        <div class="title"><span>Confirm</span><span class="close" onclick="popdown()">x</span></div>
        <div class="content">You sure?</div>
    </div>

	<div id="notification" class="alert alert-success">
	  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
	  <strong>Saved successfully!</strong>
	</div>
    <!-- <div><span><a href="#" id="ex_rate" data-name="exchange_rate" data-type="text" data-placement="right" data-title="Enter exchange rate" data-value="">Click here to input exchage rate</a></span></div> -->

	<table id="disposal" class="table table-bordered table-hover table-condensed text-center font-compacted">
	  {% csrf_token %} 
	  <thead>
	  	<tr class="btn-primary">
	  	  <th>#</th>
	  	  <th>Requester</th>
	  	  <th>CCenter</th>
	  	  <th>Project</th>
	  	  <th>Device Owner</th>
	  	  <th>Device Label</th>
	  	  <th>PreferLab</th>
	  	  <th>Expected OS</th>
	  	  <th class="btn-success">Model</th>
	  	  <th class="btn-success">Quantity</th>
	  	  <!-- <th class="btn-danger">Status</th> -->
	  	  <th class="btn-success">PO#</th>
	  	  <th class="btn-success">Price(CNY)</th>
	  	  <!-- <th class="btn-info" id="rate"><a href="#" data-value="" title="Bulk edit the exchange rate">Exrate</a></th> -->
	  	  <th class="btn-success">Exrate</a></th>
	  	  <th class="btn-success">Price(USD)</th>
	  	  <th class="btn-danger">Status</th>
	  	  <th class="btn-danger">Action</th>
	  	</tr>
	  </thead>
	  <tbody>
		{% for request in request_list %}
		<tr>
		  <td><a href="/details?t=r&pk={{ request.id }}" target="_blank">{{ request.id }}</a></td>
		  <td>{{ request.requester.ldap }}</td>
		  <td>{{ request.requester.cost_center }}</td>
		  <td>{{ request.requester.project }}</td>
		  <td>{{ request.requester.device_owner }}</td>
		  <td>{{ request.requester.device_label }}</td>
		  <td>{{ request.requester.pref_location }}</td>
		  <td>{{ request.os_version }}</td>
		  <td>{{ request.model_type }}</td>
		  <td>{{ request.quantity }}</td>
		  <!-- <td>{{ device.get_status_display }}</td>  {# don't use it as display() #} -->
		  <!-- <td><input type="text" name="po_number" size="10"></td> -->
		  <!-- <td><input type="text" name="price_cny" maxlength="5" size="5"></td> -->
		  <!-- <td><input type="text" name="price_usd" maxlength="5" size="5"></td> -->
		  <td><a href="#" data-target="req_editor" data-name="po_number" data-title="Enter PO ID" data-pk="{{ request.id }}">{{ request.po_number |default:"" }}</a></td>
		  <td><a href="#" data-target="req_editor" data-name="price_cny" data-title="Enter Price(CNY)" data-pk="{{ request.id }}">{{ request.price_cny |default:"" }}</a></td>
		  <td><a href="#" data-target="req_editor" data-name="ex_rate" data-title="Enter exchange rate" data-pk="{{ request.id }}">{{ request.ex_rate |default:"" }}</a></td>
		  <td><a href="#" data-target="req_editor" data-name="price_usd" data-title="Enter Price(USD)" data-pk="{{ request.id }}">{{ request.price_usd |default:"" }}</a></td>
		  <td>{{ request.get_status_display }}</td>

		  <td>
		    <!-- <a href="#" data-type="select" data-name="req_action" data-title="Choose action" data-pk="{{ request.id }}">{{ request.status |default:"not selected" }}</a> -->
		    <select class="form-control" data-name="req_action" data-title="Choose action" data-pk="{{ request.id }}">
		      <option></option>
		      {% if request.status == 'REQ' %}
	  	  	  <option value="REF">Decline</option>
	  	  	  <option value="APP">Approve</option>
	  	  	  {% endif %}
	  	  	  <option value="AVA">Make public</option>
	  	  	  <option value="ASS">Allocate New</option>
	  	  	  <option value="CUR">Allocate Cur</option>
	  	  	  <option value="LOC">Set location</option>
	  	  	</select>
	  	  </td>
	  	  <input id="lab_location" type="hidden" value="{{ request.lab_location }}">
		</tr>
		{% endfor %}
	  </tbody>
	</table>

{% endblock %}